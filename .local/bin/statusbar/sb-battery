#!/usr/bin/env sh

######################################################################
# @author      : swytch (adapted from Luke Smith - lukesmith.xyz)
# @file        : sb-battery
# @license     : MIT
# @created     : Saturday Feb 13, 2021 17:19:04 CET
#
# @description : battery block dwmblocks
######################################################################


# Will show all batteries with approximate icon for remaining power.
# Or show that the computer is plugged to a power source
# In any case, show the remaining battery percentage
for bat in /sys/class/power_supply/BAT?/
do
	status="$(cat "$bat/status")"
	capacity="$(cat "$bat/capacity")"
 	if [ "$status" = "Charging" ]; then
		status=""
	elif [ "$status" = "Full" ];
		printf "%s FULL" "$status";
	else
		case "$capacity" in
			100|9[0-9]|8[0-9])	status="" ;;
			7[0-9]|6[0-9])	status="" ;;
			5[0-9]|4[0-9])	status="" ;;
			3[0-9]|2[0-9])	status="" ;;
			*)		status="" ; [ "$status" != "Charging" ] && notify;;
		esac
	fi
	printf "%s %3d%%\n" "$status" "$capacity";
done && return 0
